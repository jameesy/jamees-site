{"ast":null,"code":"import fetch from 'node-fetch';\nimport { API_ENDPOINT, NOTION_TOKEN } from './server-constants';\nexport default async function rpc(fnName, body) {\n  if (!NOTION_TOKEN) {\n    throw new Error('NOTION_TOKEN is not set in env');\n  }\n\n  const res = await fetch(`${API_ENDPOINT}/${fnName}`, {\n    method: 'POST',\n    headers: {\n      'content-type': 'application/json',\n      cookie: `token_v2=${NOTION_TOKEN}`\n    },\n    body: JSON.stringify(body)\n  });\n\n  if (res.ok) {\n    return res.json();\n  } else {\n    throw new Error(await getError(res));\n  }\n}\nexport async function getError(res) {\n  return `Notion API error (${res.status}) \\n${getJSONHeaders(res)}\\n ${await getBodyOrNull(res)}`;\n}\nexport function getJSONHeaders(res) {\n  return JSON.stringify(res.headers.raw());\n}\nexport function getBodyOrNull(res) {\n  try {\n    return res.text();\n  } catch (err) {\n    return null;\n  }\n}\nexport function values(obj) {\n  const vals = [];\n  Object.keys(obj).forEach(key => {\n    vals.push(obj[key]);\n  });\n  return vals;\n}","map":null,"metadata":{},"sourceType":"module"}